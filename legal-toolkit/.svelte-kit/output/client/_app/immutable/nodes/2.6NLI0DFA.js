import"../chunks/BbkoyQuY.js";import{i as ne}from"../chunks/740EdF6i.js";import{h as W,Q as ue,R as ve,S as de,T as fe,V as _e,W as he,y as D,X as ge,D as ye,F as me,Y as ke,Z as be,G as k,I as m,J as Ae,q as y,m as q,o as a,O as f,K as n,L as u,N as U,P as E,_ as T}from"../chunks/CMYBUtCa.js";import{i as w,s as pe,a as G}from"../chunks/DT-uLrhF.js";import{i as h,A as C,e as v,u as $}from"../chunks/_9FREQyW.js";const Ie=Symbol("is custom element"),Ne=Symbol("is html");function Ee(e){if(W){var t=!1,o=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var b=e.value;Z(e,"value",null),e.value=b}if(e.hasAttribute("checked")){var r=e.checked;Z(e,"checked",null),e.checked=r}}};e.__on_r=o,ue(o),ve()}}function Z(e,t,o,b){var r=Le(e);W&&(r[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||r[t]!==(r[t]=o)&&(t==="loading"&&(e[de]=o),e.removeAttribute(t))}function Le(e){var t;return(t=e.__attributes)!=null?t:e.__attributes={[Ie]:e.nodeName.includes("-"),[Ne]:e.namespaceURI===fe}}function Se(e,t,o=t){var b=_e();he(e,"input",r=>{var c=r?e.defaultValue:e.value;if(c=H(e)?K(c):c,o(c),b&&c!==(c=t())){var M=e.selectionStart,l=e.selectionEnd;e.value=c!=null?c:"",l!==null&&(e.selectionStart=M,e.selectionEnd=Math.min(l,e.value.length))}}),(W&&e.defaultValue!==e.value||D(t)==null&&e.value)&&o(H(e)?K(e.value):e.value),ge(()=>{var r=t();H(e)&&r===K(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r!=null?r:"")})}function H(e){var t=e.type;return t==="number"||t==="range"}function K(e){return e===""?null:+e}var xe=k('<div class="loading svelte-1rdcgko">Loading...</div>'),Pe=k('<div class="welcome svelte-1rdcgko"><h2 class="svelte-1rdcgko">Welcome back!</h2> <p class="svelte-1rdcgko"> </p> <button class="delete-btn svelte-1rdcgko">Delete Account</button></div>'),we=k('<button class="secondary-btn svelte-1rdcgko">Delete Account</button>'),Me=k('<div class="auth-container svelte-1rdcgko"><div class="auth-form svelte-1rdcgko"><h2 class="svelte-1rdcgko"> </h2> <p class="info svelte-1rdcgko"> </p> <div class="input-group svelte-1rdcgko"><label for="pin" class="svelte-1rdcgko">PIN</label> <input id="pin" type="password" placeholder="Enter your PIN" maxlength="20" class="svelte-1rdcgko"/></div> <button class="primary-btn svelte-1rdcgko"> </button> <!></div></div>'),Ue=k('<div class="error svelte-1rdcgko"> </div>'),Te=k('<div class="success svelte-1rdcgko"> </div>'),Ce=k('<div class="container svelte-1rdcgko"><h1 class="svelte-1rdcgko">Legal Toolkit</h1> <p class="subtitle svelte-1rdcgko">Secure Legal Case Management</p> <!> <!> <!></div>');function Ve(e,t){ye(t,!1);const[o,b]=pe(),r=()=>G(h,"$isLoading",o),c=()=>G($,"$user",o),M=()=>G(v,"$error",o);let l=q(""),g=q(!1),A=q(null);me(async()=>{h.set(!0);try{y(g,await C.checkUserExists())}catch{v.set("Failed to check user status")}finally{h.set(!1)}});async function Y(){if(!a(l)||a(l).length<4){v.set("PIN must be at least 4 characters");return}h.set(!0);try{const s=await C.createUser(a(l));s.success?($.set({id:s.user_id,authenticated:!0}),y(A,"Account created successfully!")):v.set(s.message)}catch{v.set("Failed to create user")}finally{h.set(!1)}}async function B(){if(!a(l)){v.set("Please enter your PIN");return}h.set(!0);try{const s=await C.authenticateUser(a(l));s.success?($.set({id:s.user_id,authenticated:!0}),y(A,"Authentication successful!")):v.set(s.message)}catch{v.set("Authentication failed")}finally{h.set(!1)}}async function J(){if(confirm("Are you sure you want to delete your account? This will remove all data.")){h.set(!0);try{const s=await C.deleteUser();s.success?($.set(null),y(g,!1),y(A,"Account deleted successfully"),y(l,"")):v.set(s.message)}catch{v.set("Failed to delete account")}finally{h.set(!1)}}}function j(){v.set(null),y(A,null)}ke(()=>a(l),()=>{a(l)&&j()}),be(),ne();var F=Ce(),Q=f(n(F),4);{var z=s=>{var i=xe();m(s,i)},ee=(s,i)=>{{var L=p=>{var d=Pe(),I=f(n(d),2),S=n(I);u(I);var O=f(I,2);u(d),U(()=>{var N;return E(S,`User ID: ${(N=(c(),D(()=>c().id)))!=null?N:""}`)}),T("click",O,J),m(p,d)},re=p=>{var d=Me(),I=n(d),S=n(I),O=n(S,!0);u(S);var N=f(S,2),le=n(N,!0);u(N);var R=f(N,2),V=f(n(R),2);Ee(V),u(R);var x=f(R,2),ce=n(x,!0);u(x);var oe=f(x,2);{var ie=_=>{var P=we();T("click",P,J),m(_,P)};w(oe,_=>{a(g)&&_(ie)})}u(I),u(d),U(()=>{E(O,a(g)?"Enter your PIN":"Create your PIN"),E(le,a(g)?"Enter your PIN to access your legal cases":"Create a secure PIN to protect your legal documents (minimum 4 characters)"),x.disabled=(a(l),D(()=>!a(l)||a(l).length<4)),E(ce,a(g)?"Authenticate":"Create Account")}),Se(V,()=>a(l),_=>y(l,_)),T("keydown",V,_=>{_.key==="Enter"&&(a(g)?B():Y())}),T("click",x,function(..._){var P;(P=a(g)?B:Y)==null||P.apply(this,_)}),m(p,d)};w(s,p=>{c(),D(()=>{var d;return(d=c())==null?void 0:d.authenticated})?p(L):p(re,!1)},i)}};w(Q,s=>{r()?s(z):s(ee,!1)})}var X=f(Q,2);{var se=s=>{var i=Ue(),L=n(i,!0);u(i),U(()=>E(L,M())),m(s,i)};w(X,s=>{M()&&s(se)})}var te=f(X,2);{var ae=s=>{var i=Te(),L=n(i,!0);u(i),U(()=>E(L,a(A))),m(s,i)};w(te,s=>{a(A)&&s(ae)})}u(F),m(e,F),Ae(),b()}export{Ve as component};
