import{B as G}from"./chunks/index.js";import{json as $e,text as A}from"@sveltejs/kit";import{HttpError as Y,SvelteKitError as J,Redirect as B,ActionFailure as be}from"@sveltejs/kit/internal";import{a as D,b as P,c as te,p as et,s as qt,o as Ct,r as Ht,d as Oe,e as Ut,g as zt,f as Nt,h as Pe,i as Lt,j as It,k as Dt}from"./chunks/internal.js";import*as C from"devalue";import{m as Wt,d as tt,a as rt,v as Ft,b as Mt,c as Gt,e as Bt,n as ve,r as qe,f as Jt}from"./chunks/exports.js";import{r as Vt,w as Ce}from"./chunks/index2.js";import{parse as ee,serialize as he}from"cookie";import*as He from"set-cookie-parser";const Xt="/_svelte_kit_assets",nt=["GET","POST","PUT","PATCH","DELETE","OPTIONS","HEAD"],Kt=["GET","POST","HEAD"];function ke(e,t){const r=[];e.split(",").forEach((a,o)=>{const i=/([^/ \t]+)\/([^; \t]+)[ \t]*(?:;[ \t]*q=([0-9.]+))?/.exec(a);if(i){const[,c,f,l="1"]=i;r.push({type:c,subtype:f,q:+l,i:o})}}),r.sort((a,o)=>a.q!==o.q?o.q-a.q:a.subtype==="*"!=(o.subtype==="*")?a.subtype==="*"?1:-1:a.type==="*"!=(o.type==="*")?a.type==="*"?1:-1:a.i-o.i);let n,s=1/0;for(const a of t){const[o,i]=a.split("/"),c=r.findIndex(f=>(f.type===o||f.type==="*")&&(f.subtype===i||f.subtype==="*"));c!==-1&&c<s&&(n=a,s=c)}return n}function Qt(e,...t){const r=e.headers.get("content-type")?.split(";",1)[0].trim()??"";return t.includes(r.toLowerCase())}function st(e){return Qt(e,"application/x-www-form-urlencoded","multipart/form-data","text/plain")}let Ue=null,_e;import("node:async_hooks").then(e=>_e=new e.AsyncLocalStorage).catch(()=>{});function V(e,t){try{return Ue=e,_e?_e.run(e,t):t()}finally{Ue=null}}function Yt(e){return e instanceof Error||e&&e.name&&e.message?e:new Error(JSON.stringify(e))}function X(e){return e instanceof Y||e instanceof J?e.status:500}function Zt(e){return e instanceof J?e.text:"Internal Error"}const at={"&":"&amp;",'"':"&quot;"},ot={"&":"&amp;","<":"&lt;"},it="[\\ud800-\\udbff](?![\\udc00-\\udfff])|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\udc00-\\udfff]",er=new RegExp(`[${Object.keys(at).join("")}]|`+it,"g"),tr=new RegExp(`[${Object.keys(ot).join("")}]|`+it,"g");function xe(e,t){const r=t?at:ot;return e.replace(t?er:tr,s=>s.length===2?s:r[s]??`&#${s.charCodeAt(0)};`)}function ct(e,t){return A(`${t} method not allowed`,{status:405,headers:{allow:rr(e).join(", ")}})}function rr(e){const t=nt.filter(r=>r in e);return("GET"in e||"HEAD"in e)&&t.push("HEAD"),t}function re(e,t,r){let n=e.templates.error({status:t,message:xe(r)});return A(n,{headers:{"content-type":"text/html; charset=utf-8"},status:t})}async function ze(e,t,r){r=r instanceof Y?r:Yt(r);const n=X(r),s=await L(e,t,r),a=ke(e.request.headers.get("accept")||"text/html",["application/json","text/html"]);return e.isDataRequest||a==="application/json"?$e(s,{status:n}):re(t,n,s.message)}async function L(e,t,r){if(r instanceof Y)return r.body;const n=X(r),s=Zt(r);return await V(e,()=>t.hooks.handleError({error:r,event:e,status:n,message:s}))??{message:s}}function ne(e,t){return new Response(void 0,{status:e,headers:{location:t}})}function lt(e,t){return t.path?`Data returned from \`load\` while rendering ${e.route.id} is not serializable: ${t.message} (${t.path})`:t.path===""?`Data returned from \`load\` while rendering ${e.route.id} is not a plain object`:t.message}function ut(e){const t={};return e.uses&&e.uses.dependencies.size>0&&(t.dependencies=Array.from(e.uses.dependencies)),e.uses&&e.uses.search_params.size>0&&(t.search_params=Array.from(e.uses.search_params)),e.uses&&e.uses.params.size>0&&(t.params=Array.from(e.uses.params)),e.uses?.parent&&(t.parent=1),e.uses?.route&&(t.route=1),e.uses?.url&&(t.url=1),t}function dt(e,t){return e._.prerendered_routes.has(t)||t.at(-1)==="/"&&e._.prerendered_routes.has(t.slice(0,-1))}async function nr(e,t,r){const n=e.request.method;let s=t[n]||t.fallback;if(n==="HEAD"&&!t.HEAD&&t.GET&&(s=t.GET),!s)return ct(t,n);const a=t.prerender??r.prerender_default;if(a&&(t.POST||t.PATCH||t.PUT||t.DELETE))throw new Error("Cannot prerender endpoints that have mutative methods");if(r.prerendering&&!r.prerendering.inside_reroute&&!a){if(r.depth>0)throw new Error(`${e.route.id} is not prerenderable`);return new Response(void 0,{status:204})}try{const o=await V(e,()=>s(e));if(!(o instanceof Response))throw new Error(`Invalid response from route ${e.url.pathname}: handler should return a Response object`);if(r.prerendering&&(!r.prerendering.inside_reroute||a)){const i=new Response(o.clone().body,{status:o.status,statusText:o.statusText,headers:new Headers(o.headers)});if(i.headers.set("x-sveltekit-prerender",String(a)),r.prerendering.inside_reroute&&a)i.headers.set("x-sveltekit-routeid",encodeURI(e.route.id)),r.prerendering.dependencies.set(e.url.pathname,{response:i,body:null});else return i}return o}catch(o){if(o instanceof B)return new Response(void 0,{status:o.status,headers:{location:o.location}});throw o}}function sr(e){const{method:t,headers:r}=e.request;if(nt.includes(t)&&!Kt.includes(t))return!0;if(t==="POST"&&r.get("x-sveltekit-action")==="true")return!1;const n=e.request.headers.get("accept")??"*/*";return ke(n,["*","text/html"])!=="text/html"}function Ne(e){return e.filter(t=>t!=null)}const Ee="/__data.json",se=".html__data.json";function ar(e){return e.endsWith(Ee)||e.endsWith(se)}function je(e){return e.endsWith(".html")?e.replace(/\.html$/,se):e.replace(/\/$/,"")+Ee}function or(e){return e.endsWith(se)?e.slice(0,-se.length)+".html":e.slice(0,-Ee.length)}const Re="/__route.js";function ir(e){return e.endsWith(Re)}function ft(e){return e.replace(/\/$/,"")+Re}function cr(e){return e.slice(0,-Re.length)}function pt(e){return ke(e.request.headers.get("accept")??"*/*",["application/json","text/html"])==="application/json"&&e.request.method==="POST"}async function lr(e,t,r){const n=r?.actions;if(!n){const s=new J(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page");return K({type:"error",error:await L(e,t,s)},{status:s.status,headers:{allow:"GET"}})}mt(n);try{const s=await gt(e,n);return s instanceof be?K({type:"failure",status:s.status,data:Le(s.data,e.route.id,t.hooks.transport)}):K({type:"success",status:s?200:204,data:Le(s,e.route.id,t.hooks.transport)})}catch(s){const a=s;return a instanceof B?_t(a):K({type:"error",error:await L(e,t,ht(a))},{status:X(a)})}}function ht(e){return e instanceof be?new Error('Cannot "throw fail()". Use "return fail()"'):e}function _t(e){return K({type:"redirect",status:e.status,location:e.location})}function K(e,t){return $e(e,t)}function ur(e){return e.request.method==="POST"}async function dr(e,t){const r=t?.actions;if(!r)return e.setHeaders({allow:"GET"}),{type:"error",error:new J(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page")};mt(r);try{const n=await gt(e,r);return n instanceof be?{type:"failure",status:n.status,data:n.data}:{type:"success",status:200,data:n}}catch(n){const s=n;return s instanceof B?{type:"redirect",status:s.status,location:s.location}:{type:"error",error:ht(s)}}}function mt(e){if(e.default&&Object.keys(e).length>1)throw new Error("When using named actions, the default action cannot be used. See the docs for more info: https://svelte.dev/docs/kit/form-actions#named-actions")}async function gt(e,t){const r=new URL(e.request.url);let n="default";for(const a of r.searchParams)if(a[0].startsWith("/")){if(n=a[0].slice(1),n==="default")throw new Error('Cannot use reserved action name "default"');break}const s=t[n];if(!s)throw new J(404,"Not Found",`No action with name '${n}' found`);if(!st(e.request))throw new J(415,"Unsupported Media Type",`Form actions expect form-encoded data â€” received ${e.request.headers.get("content-type")}`);return V(e,()=>s(e))}function fr(e,t,r){const n=s=>{for(const a in r){const o=r[a].encode(s);if(o)return`app.decode('${a}', ${C.uneval(o,n)})`}};return yt(e,s=>C.uneval(s,n),t)}function Le(e,t,r){const n=Object.fromEntries(Object.entries(r).map(([s,a])=>[s,a.encode]));return yt(e,s=>C.stringify(s,n),t)}function yt(e,t,r){try{return t(e)}catch(n){const s=n;if(e instanceof Response)throw new Error(`Data returned from action inside ${r} is not serializable. Form actions need to return plain objects or fail(). E.g. return { success: true } or return fail(400, { message: "invalid" });`);if("path"in s){let a=`Data returned from action inside ${r} is not serializable: ${s.message}`;throw s.path!==""&&(a+=` (data.${s.path})`),new Error(a)}throw s}}const Ie="x-sveltekit-invalidated",De="x-sveltekit-trailing-slash";function pr(e){if(globalThis.Buffer)return Buffer.from(e).toString("base64");const t=new Uint8Array(new Uint16Array([1]).buffer)[0]>0;return btoa(new TextDecoder(t?"utf-16le":"utf-16be").decode(new Uint16Array(new Uint8Array(e))))}function hr(e,t){const r=e.split(/[/\\]/),n=t.split(/[/\\]/);for(r.pop();r[0]===n[0];)r.shift(),n.shift();let s=r.length;for(;s--;)r[s]="..";return r.concat(n).join("/")}async function Se({event:e,state:t,node:r,parent:n}){if(!r?.server)return null;let s=!0;const a={dependencies:new Set,params:new Set,parent:!1,route:!1,url:!1,search_params:new Set},o=r.server.load,i=r.server.trailingSlash;if(!o)return{type:"data",data:null,uses:a,slash:i};const c=Wt(e.url,()=>{s&&(a.url=!0)},d=>{s&&a.search_params.add(d)});t.prerendering&&tt(c);let f=!1;const l=await V(e,()=>o.call(null,{...e,fetch:(d,p)=>{const _=new URL(d instanceof Request?d.url:d,e.url);return G&&f&&a.dependencies.has(_.href),e.fetch(d,p)},depends:(...d)=>{for(const p of d){const{href:_}=new URL(p,e.url);a.dependencies.add(_)}},params:new Proxy(e.params,{get:(d,p)=>(G&&f&&typeof p=="string"&&a.params.has(p),s&&a.params.add(p),d[p])}),parent:async()=>(G&&f&&a.parent,s&&(a.parent=!0),n()),route:new Proxy(e.route,{get:(d,p)=>(G&&f&&typeof p=="string"&&a.route,s&&(a.route=!0),d[p])}),url:c,untrack(d){s=!1;try{return d()}finally{s=!0}}}));return f=!0,{type:"data",data:l??null,uses:a,slash:i}}async function wt({event:e,fetched:t,node:r,parent:n,server_data_promise:s,state:a,resolve_opts:o,csr:i}){const c=await s;return r?.universal?.load?await r.universal.load.call(null,{url:e.url,params:e.params,data:c?.data??null,route:e.route,fetch:_r(e,a,t,i,o),setHeaders:e.setHeaders,depends:()=>{},parent:n,untrack:l=>l()})??null:c?.data??null}function _r(e,t,r,n,s){const a=async(o,i)=>{const c=o instanceof Request&&o.body?o.clone().body:null,f=o instanceof Request&&[...o.headers].length?new Headers(o.headers):i?.headers;let l=await e.fetch(o,i);const d=new URL(o instanceof Request?o.url:o,e.url),p=d.origin===e.url.origin;let _;if(p)t.prerendering&&(_={response:l,body:null},t.prerendering.dependencies.set(d.pathname,_));else if(d.protocol==="https:"||d.protocol==="http:")if((o instanceof Request?o.mode:i?.mode??"cors")==="no-cors")l=new Response("",{status:l.status,statusText:l.statusText,headers:l.headers});else{const v=l.headers.get("access-control-allow-origin");if(!v||v!==e.url.origin&&v!=="*")throw new Error(`CORS error: ${v?"Incorrect":"No"} 'Access-Control-Allow-Origin' header is present on the requested resource`)}const u=new Proxy(l,{get(h,v,w){async function x($,y){const m=Number(h.status);if(isNaN(m))throw new Error(`response.status is not a number. value: "${h.status}" type: ${typeof h.status}`);r.push({url:p?d.href.slice(e.url.origin.length):d.href,method:e.request.method,request_body:o instanceof Request&&c?await mr(c):i?.body,request_headers:f,response_body:$,response:h,is_b64:y})}if(v==="arrayBuffer")return async()=>{const $=await h.arrayBuffer();return _&&(_.body=new Uint8Array($)),$ instanceof ArrayBuffer&&await x(pr($),!0),$};async function j(){const $=await h.text();return(!$||typeof $=="string")&&await x($,!1),_&&(_.body=$),$}return v==="text"?j:v==="json"?async()=>JSON.parse(await j()):Reflect.get(h,v,h)}});if(n){const h=l.headers.get;l.headers.get=v=>{const w=v.toLowerCase(),x=h.call(l.headers,w);if(x&&!w.startsWith("x-sveltekit-")&&!s.filterSerializedResponseHeaders(w,x))throw new Error(`Failed to get response header "${w}" â€” it must be included by the \`filterSerializedResponseHeaders\` option: https://svelte.dev/docs/kit/hooks#Server-hooks-handle (at ${e.route.id})`);return x}}return u};return(o,i)=>{const c=a(o,i);return c.catch(()=>{}),c}}async function mr(e){let t="";const r=e.getReader(),n=new TextDecoder;for(;;){const{done:s,value:a}=await r.read();if(s)break;t+=n.decode(a)}return t}function $t(...e){let t=5381;for(const r of e)if(typeof r=="string"){let n=r.length;for(;n;)t=t*33^r.charCodeAt(--n)}else if(ArrayBuffer.isView(r)){const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);let s=n.length;for(;s;)t=t*33^n[--s]}else throw new TypeError("value must be a string or TypedArray");return(t>>>0).toString(36)}const bt={"<":"\\u003C","\u2028":"\\u2028","\u2029":"\\u2029"},gr=new RegExp(`[${Object.keys(bt).join("")}]`,"g");function yr(e,t,r=!1){const n={};let s=null,a=null,o=!1;for(const[l,d]of e.response.headers)t(l,d)&&(n[l]=d),l==="cache-control"?s=d:l==="age"?a=d:l==="vary"&&d.trim()==="*"&&(o=!0);const i={status:e.response.status,statusText:e.response.statusText,headers:n,body:e.response_body},c=JSON.stringify(i).replace(gr,l=>bt[l]),f=['type="application/json"',"data-sveltekit-fetched",`data-url="${xe(e.url,!0)}"`];if(e.is_b64&&f.push("data-b64"),e.request_headers||e.request_body){const l=[];e.request_headers&&l.push([...new Headers(e.request_headers)].join(",")),e.request_body&&l.push(e.request_body),f.push(`data-hash="${$t(...l)}"`)}if(!r&&e.method==="GET"&&s&&!o){const l=/s-maxage=(\d+)/g.exec(s)??/max-age=(\d+)/g.exec(s);if(l){const d=+l[1]-+(a??"0");f.push(`data-ttl="${d}"`)}}return`<script ${f.join(" ")}>${c}<\/script>`}const q=JSON.stringify,wr=new TextEncoder;function We(e){me[0]||$r();const t=vt.slice(0),r=br(e);for(let s=0;s<r.length;s+=16){const a=r.subarray(s,s+16);let o,i,c,f=t[0],l=t[1],d=t[2],p=t[3],_=t[4],u=t[5],h=t[6],v=t[7];for(let w=0;w<64;w++)w<16?o=a[w]:(i=a[w+1&15],c=a[w+14&15],o=a[w&15]=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+a[w&15]+a[w+9&15]|0),o=o+v+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(h^_&(u^h))+me[w],v=h,h=u,u=_,_=p+o|0,p=d,d=l,l=f,f=o+(l&d^p&(l^d))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;t[0]=t[0]+f|0,t[1]=t[1]+l|0,t[2]=t[2]+d|0,t[3]=t[3]+p|0,t[4]=t[4]+_|0,t[5]=t[5]+u|0,t[6]=t[6]+h|0,t[7]=t[7]+v|0}const n=new Uint8Array(t.buffer);return kt(n),xt(n)}const vt=new Uint32Array(8),me=new Uint32Array(64);function $r(){function e(r){return(r-Math.floor(r))*4294967296}let t=2;for(let r=0;r<64;t++){let n=!0;for(let s=2;s*s<=t;s++)if(t%s===0){n=!1;break}n&&(r<8&&(vt[r]=e(t**(1/2))),me[r]=e(t**(1/3)),r++)}}function kt(e){for(let t=0;t<e.length;t+=4){const r=e[t+0],n=e[t+1],s=e[t+2],a=e[t+3];e[t+0]=a,e[t+1]=s,e[t+2]=n,e[t+3]=r}}function br(e){const t=wr.encode(e),r=t.length*8,n=512*Math.ceil((r+65)/512),s=new Uint8Array(n/8);s.set(t),s[t.length]=128,kt(s);const a=new Uint32Array(s.buffer);return a[a.length-2]=Math.floor(r/4294967296),a[a.length-1]=r,a}const M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");function xt(e){const t=e.length;let r="",n;for(n=2;n<t;n+=3)r+=M[e[n-2]>>2],r+=M[(e[n-2]&3)<<4|e[n-1]>>4],r+=M[(e[n-1]&15)<<2|e[n]>>6],r+=M[e[n]&63];return n===t+1&&(r+=M[e[n-2]>>2],r+=M[(e[n-2]&3)<<4],r+="=="),n===t&&(r+=M[e[n-2]>>2],r+=M[(e[n-2]&3)<<4|e[n-1]>>4],r+=M[(e[n-1]&15)<<2],r+="="),r}const Fe=new Uint8Array(16);function vr(){return crypto.getRandomValues(Fe),xt(Fe)}const kr=new Set(["self","unsafe-eval","unsafe-hashes","unsafe-inline","none","strict-dynamic","report-sample","wasm-unsafe-eval","script"]),xr=/^(nonce|sha\d\d\d)-/;class Et{#e;#t;#c;#l;#u;#d;#f;#p;#n;#s;#a;#o;#i;#r;#h;constructor(t,r,n){this.#e=t,this.#n=r;const s=this.#n;this.#s=[],this.#a=[],this.#o=[],this.#i=[],this.#r=[];const a=s["script-src"]||s["default-src"],o=s["script-src-elem"],i=s["style-src"]||s["default-src"],c=s["style-src-attr"],f=s["style-src-elem"],l=d=>!!d&&!d.some(p=>p==="unsafe-inline");this.#c=l(a),this.#l=l(o),this.#d=l(i),this.#f=l(c),this.#p=l(f),this.#t=this.#c||this.#l,this.#u=this.#d||this.#f||this.#p,this.script_needs_nonce=this.#t&&!this.#e,this.style_needs_nonce=this.#u&&!this.#e,this.#h=n}add_script(t){if(!this.#t)return;const r=this.#e?`sha256-${We(t)}`:`nonce-${this.#h}`;this.#c&&this.#s.push(r),this.#l&&this.#a.push(r)}add_style(t){if(!this.#u)return;const r=this.#e?`sha256-${We(t)}`:`nonce-${this.#h}`;if(this.#d&&this.#o.push(r),this.#f&&this.#i.push(r),this.#p){const n="sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=",s=this.#n;s["style-src-elem"]&&!s["style-src-elem"].includes(n)&&!this.#r.includes(n)&&this.#r.push(n),r!==n&&this.#r.push(r)}}get_header(t=!1){const r=[],n={...this.#n};this.#o.length>0&&(n["style-src"]=[...n["style-src"]||n["default-src"]||[],...this.#o]),this.#i.length>0&&(n["style-src-attr"]=[...n["style-src-attr"]||[],...this.#i]),this.#r.length>0&&(n["style-src-elem"]=[...n["style-src-elem"]||[],...this.#r]),this.#s.length>0&&(n["script-src"]=[...n["script-src"]||n["default-src"]||[],...this.#s]),this.#a.length>0&&(n["script-src-elem"]=[...n["script-src-elem"]||[],...this.#a]);for(const s in n){if(t&&(s==="frame-ancestors"||s==="report-uri"||s==="sandbox"))continue;const a=n[s];if(!a)continue;const o=[s];Array.isArray(a)&&a.forEach(i=>{kr.has(i)||xr.test(i)?o.push(`'${i}'`):o.push(i)}),r.push(o.join(" "))}return r.join("; ")}}class Er extends Et{get_meta(){const t=this.get_header(!0);if(t)return`<meta http-equiv="content-security-policy" content="${xe(t,!0)}">`}}class jr extends Et{constructor(t,r,n){if(super(t,r,n),Object.values(r).filter(s=>!!s).length>0){const s=r["report-to"]?.length??!1,a=r["report-uri"]?.length??!1;if(!s&&!a)throw Error("`content-security-policy-report-only` must be specified with either the `report-to` or `report-uri` directives, or both")}}}class Rr{nonce=vr();csp_provider;report_only_provider;constructor({mode:t,directives:r,reportOnly:n},{prerender:s}){const a=t==="hash"||t==="auto"&&s;this.csp_provider=new Er(a,r,this.nonce),this.report_only_provider=new jr(a,n,this.nonce)}get script_needs_nonce(){return this.csp_provider.script_needs_nonce||this.report_only_provider.script_needs_nonce}get style_needs_nonce(){return this.csp_provider.style_needs_nonce||this.report_only_provider.style_needs_nonce}add_script(t){this.csp_provider.add_script(t),this.report_only_provider.add_script(t)}add_style(t){this.csp_provider.add_style(t),this.report_only_provider.add_style(t)}}function Me(){let e,t;return{promise:new Promise((n,s)=>{e=n,t=s}),fulfil:e,reject:t}}function jt(){const e=[Me()];return{iterator:{[Symbol.asyncIterator](){return{next:async()=>{const t=await e[0].promise;return t.done||e.shift(),t}}}},push:t=>{e[e.length-1].fulfil({value:t,done:!1}),e.push(Me())},done:()=>{e[e.length-1].fulfil({done:!0})}}}function Rt(e,t,r){const n={},s=e.slice(1),a=s.filter(i=>i!==void 0);let o=0;for(let i=0;i<t.length;i+=1){const c=t[i];let f=s[i-o];if(c.chained&&c.rest&&o&&(f=s.slice(i-o,i+1).filter(l=>l).join("/"),o=0),f===void 0){c.rest&&(n[c.name]="");continue}if(!c.matcher||r[c.matcher](f)){n[c.name]=f;const l=t[i+1],d=s[i+1];l&&!l.rest&&l.optional&&d&&c.chained&&(o=0),!l&&!d&&Object.keys(n).length===a.length&&(o=0);continue}if(c.optional&&c.chained){o++;continue}return}if(!o)return n}function St(e,t,r){const{errors:n,layouts:s,leaf:a}=e,o=[...n,...s.map(i=>i?.[1]),a[1]].filter(i=>typeof i=="number").map(i=>`'${i}': () => ${Tt(r._.client.nodes?.[i],t)}`).join(`,
		`);return[`{
	id: ${q(e.id)}`,`errors: ${q(e.errors)}`,`layouts: ${q(e.layouts)}`,`leaf: ${q(e.leaf)}`,`nodes: {
		${o}
	}
}`].join(`,
	`)}function Tt(e,t){if(!e)return"Promise.resolve({})";if(e[0]==="/")return`import('${e}')`;if(D!=="")return`import('${D}/${e}')`;let r=hr(t.pathname,`${P}/${e}`);return r[0]!=="."&&(r=`./${r}`),`import('${r}')`}async function Sr(e,t,r){if(!r._.client.routes)return A("Server-side route resolution disabled",{status:400});let n=null,s={};const a=await r._.matchers();for(const o of r._.client.routes){const i=o.pattern.exec(e);if(!i)continue;const c=Rt(i,o.params,a);if(c){n=o,s=rt(c);break}}return At(n,s,t,r).response}function At(e,t,r,n){const s=new Headers({"content-type":"application/javascript; charset=utf-8"});if(e){const a=St(e,r,n),o=`${Tr(e,r,n)}
export const route = ${a}; export const params = ${JSON.stringify(t)};`;return{response:A(o,{headers:s}),body:o}}else return{response:A("",{headers:s}),body:""}}function Tr(e,t,r){const{errors:n,layouts:s,leaf:a}=e;let o="";for(const i of[...n,...s.map(c=>c?.[1]),a[1]]){if(typeof i!="number")continue;const c=r._.client.css?.[i];for(const f of c??[])o+=`'${D||P}/${f}',`}return o?`${Tt(r._.client.start,t)}.then(x => x.load_css([${o}]));`:""}const Ar={...Vt(!1),check:()=>!1},Ge=new TextEncoder;async function Q({branch:e,fetched:t,options:r,manifest:n,state:s,page_config:a,status:o,error:i=null,event:c,resolve_opts:f,action_result:l}){if(s.prerendering){if(r.csp.mode==="nonce")throw new Error('Cannot use prerendering if config.kit.csp.mode === "nonce"');if(r.app_template_contains_nonce)throw new Error("Cannot use prerendering if page template contains %sveltekit.nonce%")}const{client:d}=n._,p=new Set(d.imports),_=new Set(d.stylesheets),u=new Set(d.fonts),h=new Set,v=new Map;let w;const x=l?.type==="success"||l?.type==="failure"?l.data??null:null;let j=P,$=D,y=q(P);if(s.prerendering?.fallback?r.hash_routing&&(y="new URL('.', location).pathname.slice(0, -1)"):(j=c.url.pathname.slice(P.length).split("/").slice(2).map(()=>"..").join("/")||".",y=`new URL(${q(j)}, location).pathname.slice(0, -1)`,(!D||D[0]==="/"&&D!==Xt)&&($=j)),a.ssr){const E={stores:{page:Ce(null),navigating:Ce(null),updated:Ar},constructors:await Promise.all(e.map(({node:T})=>{if(!T.component)throw new Error(`Missing +page.svelte component for route ${c.route.id}`);return T.component()})),form:x};let R={};for(let T=0;T<e.length;T+=1)R={...R,...e[T].data},E[`data_${T}`]=R;E.page={error:i,params:c.params,route:c.route,status:o,url:c.url,data:R,form:x,state:{}},Ct({base:j,assets:$});const F={context:new Map([["__request__",{page:E.page}]])};try{w=r.root.render(E,F)}finally{Ht()}for(const{node:T}of e){for(const U of T.imports)p.add(U);for(const U of T.stylesheets)_.add(U);for(const U of T.fonts)u.add(U);T.inline_styles&&!d.inline&&Object.entries(await T.inline_styles()).forEach(([U,Z])=>v.set(U,Z))}}else w={head:"",html:"",css:{code:"",map:null}};let m="",g=w.html;const b=new Rr(r.csp,{prerender:!!s.prerendering}),k=E=>E.startsWith("/")?P+E:`${$}/${E}`,S=d.inline?d.inline?.style:Array.from(v.values()).join(`
`);if(S){const E=[];b.style_needs_nonce&&E.push(` nonce="${b.nonce}"`),b.add_style(S),m+=`
	<style${E.join("")}>${S}</style>`}for(const E of _){const R=k(E),F=['rel="stylesheet"'];if(v.has(E))F.push("disabled",'media="(max-width: 0)"');else if(f.preload({type:"css",path:R})){const T=['rel="preload"','as="style"'];h.add(`<${encodeURI(R)}>; ${T.join(";")}; nopush`)}m+=`
		<link href="${R}" ${F.join(" ")}>`}for(const E of u){const R=k(E);if(f.preload({type:"font",path:R})){const T=['rel="preload"','as="font"',`type="font/${E.slice(E.lastIndexOf(".")+1)}"`,`href="${R}"`,"crossorigin"];m+=`
		<link ${T.join(" ")}>`}}const O=`__sveltekit_${r.version_hash}`,{data:W,chunks:H}=Or(c,r,e.map(E=>E.server_data),b,O);if(a.ssr&&a.csr&&(g+=`
			${t.map(E=>yr(E,f.filterSerializedResponseHeaders,!!s.prerendering)).join(`
			`)}`),a.csr){const E=n._.client.routes?.find(z=>z.id===c.route.id)??null;if(d.uses_env_dynamic_public&&s.prerendering&&p.add(`${te}/env.js`),!d.inline){const z=Array.from(p,N=>k(N)).filter(N=>f.preload({type:"js",path:N}));for(const N of z)h.add(`<${encodeURI(N)}>; rel="modulepreload"; nopush`),r.preload_strategy!=="modulepreload"?m+=`
		<link rel="preload" as="script" crossorigin="anonymous" href="${N}">`:s.prerendering&&(m+=`
		<link rel="modulepreload" href="${N}">`)}if(n._.client.routes&&s.prerendering&&!s.prerendering.fallback){const z=ft(c.url.pathname);s.prerendering.dependencies.set(z,At(E,c.params,new URL(z,c.url),n))}const R=[],F=d.uses_env_dynamic_public&&s.prerendering,T=[`base: ${y}`];D&&T.push(`assets: ${q(D)}`),d.uses_env_dynamic_public&&T.push(`env: ${F?"null":q(et)}`),H&&(R.push("const deferred = new Map();"),T.push(`defer: (id) => new Promise((fulfil, reject) => {
							deferred.set(id, { fulfil, reject });
						})`),T.push(`resolve: ({ id, data, error }) => {
							const try_to_resolve = () => {
								if (!deferred.has(id)) {
									setTimeout(try_to_resolve, 0);
									return;
								}
								const { fulfil, reject } = deferred.get(id);
								deferred.delete(id);
								if (error) reject(error);
								else fulfil(data);
							}
							try_to_resolve();
						}`)),R.push(`${O} = {
						${T.join(`,
						`)}
					};`);const U=["element"];if(R.push("const element = document.currentScript.parentElement;"),a.ssr){const z={form:"null",error:"null"};x&&(z.form=fr(x,c.route.id,r.hooks.transport)),i&&(z.error=C.uneval(i));const N=[`node_ids: [${e.map(({node:ce})=>ce.index).join(", ")}]`,`data: ${W}`,`form: ${z.form}`,`error: ${z.error}`];if(o!==200&&N.push(`status: ${o}`),n._.client.routes){if(E){const ce=St(E,c.url,n).replaceAll(`
`,`
							`);N.push(`params: ${C.uneval(c.params)}`,`server_route: ${ce}`)}}else r.embedded&&N.push(`params: ${C.uneval(c.params)}`,`route: ${q(c.route)}`);const ie="	".repeat(F?7:6);U.push(`{
${ie}	${N.join(`,
${ie}	`)}
${ie}}`)}const Z=d.inline?`${d.inline.script}

					__sveltekit_${r.version_hash}.app.start(${U.join(", ")});`:d.app?`Promise.all([
						import(${q(k(d.start))}),
						import(${q(k(d.app))})
					]).then(([kit, app]) => {
						kit.start(app, ${U.join(", ")});
					});`:`import(${q(k(d.start))}).then((app) => {
						app.start(${U.join(", ")})
					});`;F?R.push(`import(${q(`${j}/${te}/env.js`)}).then(({ env }) => {
						${O}.env = env;

						${Z.replace(/\n/g,`
	`)}
					});`):R.push(Z),r.service_worker&&R.push(`if ('serviceWorker' in navigator) {
						addEventListener('load', function () {
							navigator.serviceWorker.register('${k("service-worker.js")}');
						});
					}`);const Ae=`
				{
					${R.join(`

					`)}
				}
			`;b.add_script(Ae),g+=`
			<script${b.script_needs_nonce?` nonce="${b.nonce}"`:""}>${Ae}<\/script>
		`}const I=new Headers({"x-sveltekit-page":"true","content-type":"text/html"});if(s.prerendering){const E=[],R=b.csp_provider.get_meta();R&&E.push(R),s.prerendering.cache&&E.push(`<meta http-equiv="cache-control" content="${s.prerendering.cache}">`),E.length>0&&(m=E.join(`
`)+m)}else{const E=b.csp_provider.get_header();E&&I.set("content-security-policy",E);const R=b.report_only_provider.get_header();R&&I.set("content-security-policy-report-only",R),h.size&&I.set("link",Array.from(h).join(", "))}m+=w.head;const ae=r.templates.app({head:m,body:g,assets:$,nonce:b.nonce,env:qt}),oe=await f.transformPageChunk({html:ae,done:!0})||"";return H||I.set("etag",`"${$t(oe)}"`),H?new Response(new ReadableStream({async start(E){E.enqueue(Ge.encode(oe+`
`));for await(const R of H)E.enqueue(Ge.encode(R));E.close()},type:"bytes"}),{headers:I}):A(oe,{status:o,headers:I})}function Or(e,t,r,n,s){let a=1,o=0;const{iterator:i,push:c,done:f}=jt();function l(d){if(typeof d?.then=="function"){const p=a++;return o+=1,d.then(_=>({data:_})).catch(async _=>({error:await L(e,t,_)})).then(async({data:_,error:u})=>{o-=1;let h;try{h=C.uneval({id:p,data:_,error:u},l)}catch{u=await L(e,t,new Error(`Failed to serialize promise while rendering ${e.route.id}`)),_=void 0,h=C.uneval({id:p,data:_,error:u},l)}const v=n.script_needs_nonce?` nonce="${n.nonce}"`:"";c(`<script${v}>${s}.resolve(${h})<\/script>
`),o===0&&f()}),`${s}.defer(${p})`}else for(const p in t.hooks.transport){const _=t.hooks.transport[p].encode(d);if(_)return`app.decode('${p}', ${C.uneval(_,l)})`}}try{return{data:`[${r.map(p=>{if(!p)return"null";const _={type:"data",data:p.data,uses:ut(p)};return p.slash&&(_.slash=p.slash),C.uneval(_,l)}).join(",")}]`,chunks:o>0?i:null}}catch(d){throw d.path=d.path.slice(1),new Error(lt(e,d))}}class Te{data;constructor(t){this.data=t}layouts(){return this.data.slice(0,-1)}page(){return this.data.at(-1)}validate(){for(const r of this.layouts())r&&(Ft(r.server,r.server_id),Mt(r.universal,r.universal_id));const t=this.page();t&&(Gt(t.server,t.server_id),Bt(t.universal,t.universal_id))}#e(t){return this.data.reduce((r,n)=>n?.universal?.[t]??n?.server?.[t]??r,void 0)}csr(){return this.#e("csr")??!0}ssr(){return this.#e("ssr")??!0}prerender(){return this.#e("prerender")??!1}trailing_slash(){return this.#e("trailingSlash")??"never"}get_config(){let t={};for(const r of this.data)!r?.universal?.config&&!r?.server?.config||(t={...t,...r?.universal?.config,...r?.server?.config});return Object.keys(t).length?t:void 0}should_prerender_data(){return this.data.some(t=>t?.server?.load||t?.server?.trailingSlash!==void 0)}}async function Ot({event:e,options:t,manifest:r,state:n,status:s,error:a,resolve_opts:o}){if(e.request.headers.get("x-sveltekit-error"))return re(t,s,a.message);const i=[];try{const c=[],f=await r._.nodes[0](),l=new Te([f]),d=l.ssr(),p=l.csr();if(d){n.error=!0;const _=Se({event:e,state:n,node:f,parent:async()=>({})}),u=await _,h=await wt({event:e,fetched:i,node:f,parent:async()=>({}),resolve_opts:o,server_data_promise:_,state:n,csr:p});c.push({node:f,server_data:u,data:h},{node:await r._.nodes[1](),data:null,server_data:null})}return await Q({options:t,manifest:r,state:n,page_config:{ssr:d,csr:p},status:s,error:await L(e,t,a),branch:c,fetched:i,event:e,resolve_opts:o})}catch(c){return c instanceof B?ne(c.status,c.location):re(t,X(c),(await L(e,t,c)).message)}}function Pr(e){let t=!1,r;return()=>t?r:(t=!0,r=e())}const Be=new TextEncoder;async function qr(e,t,r,n,s,a,o){if(!t.page)return new Response(void 0,{status:404});try{const i=[...t.page.layouts,t.page.leaf],c=a??i.map(()=>!0);let f=!1;const l=new URL(e.url);l.pathname=ve(l.pathname,o);const d={...e,url:l},p=i.map((x,j)=>Pr(async()=>{try{if(f)return{type:"skip"};const $=x==null?x:await n._.nodes[x]();return Se({event:d,state:s,node:$,parent:async()=>{const y={};for(let m=0;m<j;m+=1){const g=await p[m]();g&&Object.assign(y,g.data)}return y}})}catch($){throw f=!0,$}})),_=p.map(async(x,j)=>c[j]?x():{type:"skip"});let u=_.length;const h=await Promise.all(_.map((x,j)=>x.catch(async $=>{if($ instanceof B)throw $;return u=Math.min(u,j+1),{type:"error",error:await L(e,r,$),status:$ instanceof Y||$ instanceof J?$.status:void 0}}))),{data:v,chunks:w}=Pt(e,r,h);return w?new Response(new ReadableStream({async start(x){x.enqueue(Be.encode(v));for await(const j of w)x.enqueue(Be.encode(j));x.close()},type:"bytes"}),{headers:{"content-type":"text/sveltekit-data","cache-control":"private, no-store"}}):ge(v)}catch(i){const c=i;return c instanceof B?ye(c):ge(await L(e,r,c),500)}}function ge(e,t=200){return A(typeof e=="string"?e:JSON.stringify(e),{status:t,headers:{"content-type":"application/json","cache-control":"private, no-store"}})}function ye(e){return ge({type:"redirect",location:e.location})}function Pt(e,t,r){let n=1,s=0;const{iterator:a,push:o,done:i}=jt(),c={...Object.fromEntries(Object.entries(t.hooks.transport).map(([f,l])=>[f,l.encode])),Promise:f=>{if(typeof f?.then=="function"){const l=n++;s+=1;let d="data";return f.catch(async p=>(d="error",L(e,t,p))).then(async p=>{let _;try{_=C.stringify(p,c)}catch{const u=await L(e,t,new Error(`Failed to serialize promise while rendering ${e.route.id}`));d="error",_=C.stringify(u,c)}s-=1,o(`{"type":"chunk","id":${l},"${d}":${_}}
`),s===0&&i()}),l}}};try{return{data:`{"type":"data","nodes":[${r.map(l=>l?l.type==="error"||l.type==="skip"?JSON.stringify(l):`{"type":"data","data":${C.stringify(l.data,c)},"uses":${JSON.stringify(ut(l))}${l.slash?`,"slash":${JSON.stringify(l.slash)}`:""}}`:"null").join(",")}]}
`,chunks:s>0?a:null}}catch(f){throw f.path="data"+f.path,new Error(lt(e,f))}}const Cr=10;async function Hr(e,t,r,n,s,a,o){if(s.depth>Cr)return A(`Not found: ${e.url.pathname}`,{status:404});if(pt(e)){const i=await n._.nodes[t.leaf]();return lr(e,r,i?.server)}try{const i=a.page();let c=200,f;if(ur(e)){if(f=await dr(e,i.server),f?.type==="redirect")return ne(f.status,f.location);f?.type==="error"&&(c=X(f.error)),f?.type==="failure"&&(c=f.status)}const l=a.prerender();if(l){if(i.server?.actions)throw new Error("Cannot prerender pages with actions")}else if(s.prerendering)return new Response(void 0,{status:204});s.prerender_default=l;const d=a.should_prerender_data(),p=je(e.url.pathname),_=[],u=a.ssr(),h=a.csr();if(u===!1&&!(s.prerendering&&d))return G&&f&&e.request.headers.has("x-sveltekit-action"),await Q({branch:[],fetched:_,page_config:{ssr:!1,csr:h},status:c,error:null,event:e,options:r,manifest:n,state:s,resolve_opts:o});const v=[];let w=null;const x=a.data.map(($,y)=>{if(w)throw w;return Promise.resolve().then(async()=>{try{if($===i&&f?.type==="error")throw f.error;return await Se({event:e,state:s,node:$,parent:async()=>{const m={};for(let g=0;g<y;g+=1){const b=await x[g];b&&Object.assign(m,b.data)}return m}})}catch(m){throw w=m,w}})}),j=a.data.map(($,y)=>{if(w)throw w;return Promise.resolve().then(async()=>{try{return await wt({event:e,fetched:_,node:$,parent:async()=>{const m={};for(let g=0;g<y;g+=1)Object.assign(m,await j[g]);return m},resolve_opts:o,server_data_promise:x[y],state:s,csr:h})}catch(m){throw w=m,w}})});for(const $ of x)$.catch(()=>{});for(const $ of j)$.catch(()=>{});for(let $=0;$<a.data.length;$+=1){const y=a.data[$];if(y)try{const m=await x[$],g=await j[$];v.push({node:y,server_data:m,data:g})}catch(m){const g=m;if(g instanceof B){if(s.prerendering&&d){const S=JSON.stringify({type:"redirect",location:g.location});s.prerendering.dependencies.set(p,{response:A(S),body:S})}return ne(g.status,g.location)}const b=X(g),k=await L(e,r,g);for(;$--;)if(t.errors[$]){const S=t.errors[$],O=await n._.nodes[S]();let W=$;for(;!v[W];)W-=1;const H=Ne(v.slice(0,W+1)),I=new Te(H.map(ae=>ae.node));return await Q({event:e,options:r,manifest:n,state:s,resolve_opts:o,page_config:{ssr:I.ssr(),csr:I.csr()},status:b,error:k,branch:H.concat({node:O,data:null,server_data:null}),fetched:_})}return re(r,b,k.message)}else v.push(null)}if(s.prerendering&&d){let{data:$,chunks:y}=Pt(e,r,v.map(m=>m?.server_data));if(y)for await(const m of y)$+=m;s.prerendering.dependencies.set(p,{response:A($),body:$})}return await Q({event:e,options:r,manifest:n,state:s,resolve_opts:o,page_config:{csr:h,ssr:u},status:c,error:null,branch:u===!1?[]:Ne(v),action_result:f,fetched:_})}catch(i){return await Ot({event:e,options:r,manifest:n,state:s,status:500,error:i,resolve_opts:o})}}const Ur=/[\x00-\x1F\x7F()<>@,;:"/[\]?={} \t]/;function le(e){if(e?.path===void 0)throw new Error("You must specify a `path` when setting, deleting or serializing cookies")}function zr(e,t){const r=e.headers.get("cookie")??"",n=ee(r,{decode:p=>p});let s;const a={},o={httpOnly:!0,sameSite:"lax",secure:!(t.hostname==="localhost"&&t.protocol==="http:")},i={get(p,_){const u=a[p];return u&&ue(t.hostname,u.options.domain)&&de(t.pathname,u.options.path)?u.value:ee(r,{decode:_?.decode})[p]},getAll(p){const _=ee(r,{decode:p?.decode});for(const u of Object.values(a))ue(t.hostname,u.options.domain)&&de(t.pathname,u.options.path)&&(_[u.name]=u.value);return Object.entries(_).map(([u,h])=>({name:u,value:h}))},set(p,_,u){const h=p.match(Ur);h&&console.warn(`The cookie name "${p}" will be invalid in SvelteKit 3.0 as it contains ${h.join(" and ")}. See RFC 2616 for more details https://datatracker.ietf.org/doc/html/rfc2616#section-2.2`),le(u),l(p,_,{...o,...u})},delete(p,_){le(_),i.set(p,"",{..._,maxAge:0})},serialize(p,_,u){le(u);let h=u.path;if(!u.domain||u.domain===t.hostname){if(!s)throw new Error("Cannot serialize cookies until after the route is determined");h=qe(s,h)}return he(p,_,{...o,...u,path:h})}};function c(p,_){const u={...n};for(const h in a){const v=a[h];if(!ue(p.hostname,v.options.domain)||!de(p.pathname,v.options.path))continue;const w=v.options.encode||encodeURIComponent;u[v.name]=w(v.value)}if(_){const h=ee(_,{decode:v=>v});for(const v in h)u[v]=h[v]}return Object.entries(u).map(([h,v])=>`${h}=${v}`).join("; ")}const f=[];function l(p,_,u){if(!s){f.push(()=>l(p,_,u));return}let h=u.path;(!u.domain||u.domain===t.hostname)&&(h=qe(s,h)),a[p]={name:p,value:_,options:{...u,path:h}}}function d(p){s=ve(t.pathname,p),f.forEach(_=>_())}return{cookies:i,new_cookies:a,get_cookie_header:c,set_internal:l,set_trailing_slash:d}}function ue(e,t){if(!t)return!0;const r=t[0]==="."?t.slice(1):t;return e===r?!0:e.endsWith("."+r)}function de(e,t){if(!t)return!0;const r=t.endsWith("/")?t.slice(0,-1):t;return e===r?!0:e.startsWith(r+"/")}function Je(e,t){for(const r of t){const{name:n,value:s,options:a}=r;if(e.append("set-cookie",he(n,s,a)),a.path.endsWith(".html")){const o=je(a.path);e.append("set-cookie",he(n,s,{...a,path:o}))}}}function Nr({event:e,options:t,manifest:r,state:n,get_cookie_header:s,set_internal:a}){const o=async(i,c)=>{const f=Ve(i,c,e.url);let l=(i instanceof Request?i.mode:c?.mode)??"cors",d=(i instanceof Request?i.credentials:c?.credentials)??"same-origin";return t.hooks.handleFetch({event:e,request:f,fetch:async(p,_)=>{const u=Ve(p,_,e.url),h=new URL(u.url);if(u.headers.has("origin")||u.headers.set("origin",e.url.origin),p!==f&&(l=(p instanceof Request?p.mode:_?.mode)??"cors",d=(p instanceof Request?p.credentials:_?.credentials)??"same-origin"),(u.method==="GET"||u.method==="HEAD")&&(l==="no-cors"&&h.origin!==e.url.origin||h.origin===e.url.origin)&&u.headers.delete("origin"),h.origin!==e.url.origin){if(`.${h.hostname}`.endsWith(`.${e.url.hostname}`)&&d!=="omit"){const b=s(h,u.headers.get("cookie"));b&&u.headers.set("cookie",b)}return fetch(u)}const v=D||P,w=decodeURIComponent(h.pathname),x=(w.startsWith(v)?w.slice(v.length):w).slice(1),j=`${x}/index.html`,$=r.assets.has(x)||x in r._.server_assets,y=r.assets.has(j)||j in r._.server_assets;if($||y){const b=$?x:j;if(n.read){const k=$?r.mimeTypes[x.slice(x.lastIndexOf("."))]:"text/html";return new Response(n.read(b),{headers:k?{"content-type":k}:{}})}else if(Oe&&b in r._.server_assets){const k=r._.server_assets[b],S=r.mimeTypes[b.slice(b.lastIndexOf("."))];return new Response(Oe(b),{headers:{"Content-Length":""+k,"Content-Type":S}})}return await fetch(u)}if(dt(r,P+w))return await fetch(u);if(d!=="omit"){const b=s(h,u.headers.get("cookie"));b&&u.headers.set("cookie",b);const k=e.request.headers.get("authorization");k&&!u.headers.has("authorization")&&u.headers.set("authorization",k)}u.headers.has("accept")||u.headers.set("accept","*/*"),u.headers.has("accept-language")||u.headers.set("accept-language",e.request.headers.get("accept-language"));const m=await Lr(u,t,r,n),g=m.headers.get("set-cookie");if(g)for(const b of He.splitCookiesString(g)){const{name:k,value:S,...O}=He.parseString(b,{decodeValues:!1}),W=O.path??(h.pathname.split("/").slice(0,-1).join("/")||"/");a(k,S,{path:W,encode:H=>H,...O})}return m}})};return(i,c)=>{const f=o(i,c);return f.catch(()=>{}),f}}function Ve(e,t,r){return e instanceof Request?e:new Request(typeof e=="string"?new URL(e,r):e,t)}async function Lr(e,t,r,n){if(e.signal){if(e.signal.aborted)throw new DOMException("The operation was aborted.","AbortError");let s=()=>{};const a=new Promise((i,c)=>{const f=()=>{c(new DOMException("The operation was aborted.","AbortError"))};e.signal.addEventListener("abort",f,{once:!0}),s=()=>e.signal.removeEventListener("abort",f)}),o=await Promise.race([we(e,t,r,{...n,depth:n.depth+1}),a]);return s(),o}else return await we(e,t,r,{...n,depth:n.depth+1})}let Xe,fe,pe;function Ir(e){return Xe??=`export const env=${JSON.stringify(et)}`,fe??=`W/${Date.now()}`,pe??=new Headers({"content-type":"application/javascript; charset=utf-8",etag:fe}),e.headers.get("if-none-match")===fe?new Response(void 0,{status:304,headers:pe}):new Response(Xe,{headers:pe})}const Ke=({html:e})=>e,Qe=()=>!1,Ye=({type:e})=>e==="js"||e==="css",Dr=new Set(["GET","HEAD","POST"]),Wr=new Set(["GET","HEAD","OPTIONS"]);async function we(e,t,r,n){const s=new URL(e.url);if(t.csrf_check_origin&&st(e)&&(e.method==="POST"||e.method==="PUT"||e.method==="PATCH"||e.method==="DELETE")&&e.headers.get("origin")!==s.origin){const m=new Y(403,`Cross-site ${e.method} form submissions are forbidden`);return e.headers.get("accept")==="application/json"?$e(m.body,{status:m.status}):A(m.body.message,{status:m.status})}if(t.hash_routing&&s.pathname!==P+"/"&&s.pathname!=="/[fallback]")return A("Not found",{status:404});let a;const o=ir(s.pathname),i=ar(s.pathname);o?s.pathname=cr(s.pathname):i&&(s.pathname=or(s.pathname)+(s.searchParams.get(De)==="1"?"/":"")||"/",s.searchParams.delete(De),a=s.searchParams.get(Ie)?.split("").map(y=>y==="1"),s.searchParams.delete(Ie));const c={},{cookies:f,new_cookies:l,get_cookie_header:d,set_internal:p,set_trailing_slash:_}=zr(e,s),u={cookies:f,fetch:null,getClientAddress:n.getClientAddress||(()=>{throw new Error("@sveltejs/adapter-static does not specify getClientAddress. Please raise an issue")}),locals:{},params:{},platform:n.platform,request:e,route:{id:null},setHeaders:y=>{for(const m in y){const g=m.toLowerCase(),b=y[m];if(g==="set-cookie")throw new Error("Use `event.cookies.set(name, value, options)` instead of `event.setHeaders` to set cookies");if(g in c)throw new Error(`"${m}" header is already set`);c[g]=b,n.prerendering&&g==="cache-control"&&(n.prerendering.cache=b)}},url:s,isDataRequest:i,isSubRequest:n.depth>0};u.fetch=Nr({event:u,options:t,manifest:r,state:n,get_cookie_header:d,set_internal:p}),n.emulator?.platform&&(u.platform=await n.emulator.platform({config:{},prerender:!!n.prerendering?.fallback}));let h;const v=n.prerendering?.inside_reroute;try{n.prerendering&&(n.prerendering.inside_reroute=!0),h=await t.hooks.reroute({url:new URL(s),fetch:u.fetch})??s.pathname}catch{return A("Internal Server Error",{status:500})}finally{n.prerendering&&(n.prerendering.inside_reroute=v)}try{h=Jt(h)}catch{return A("Malformed URI",{status:400})}if(h!==s.pathname&&!n.prerendering?.fallback&&dt(r,h)){const y=new URL(e.url);y.pathname=i?je(h):o?ft(h):h;const m=await fetch(y,e),g=new Headers(m.headers);return g.has("content-encoding")&&(g.delete("content-encoding"),g.delete("content-length")),new Response(m.body,{headers:g,status:m.status,statusText:m.statusText})}let w=null;if(P&&!n.prerendering?.fallback){if(!h.startsWith(P))return A("Not found",{status:404});h=h.slice(P.length)||"/"}if(o)return Sr(h,new URL(e.url),r);if(h===`/${te}/env.js`)return Ir(e);if(h.startsWith(`/${te}`)){const y=new Headers;return y.set("cache-control","public, max-age=0, must-revalidate"),A("Not found",{status:404,headers:y})}if(!n.prerendering?.fallback){const y=await r._.matchers();for(const m of r._.routes){const g=m.pattern.exec(h);if(!g)continue;const b=Rt(g,m.params,y);if(b){w=m,u.route={id:w.id},u.params=rt(b);break}}}let x={transformPageChunk:Ke,filterSerializedResponseHeaders:Qe,preload:Ye},j="never";try{const y=w?.page?new Te(await Fr(w.page,r)):void 0;if(w){if(s.pathname===P||s.pathname===P+"/"?j="always":y?j=y.trailing_slash():w.endpoint&&(j=(await w.endpoint()).trailingSlash??"never"),!i){const g=ve(s.pathname,j);if(g!==s.pathname&&!n.prerendering?.fallback)return new Response(void 0,{status:308,headers:{"x-sveltekit-normalize":"1",location:(g.startsWith("//")?s.origin+g:g)+(s.search==="?"?"":s.search)}})}if(n.before_handle||n.emulator?.platform){let g={},b=!1;if(w.endpoint){const k=await w.endpoint();g=k.config??g,b=k.prerender??b}else y&&(g=y.get_config()??g,b=y.prerender());n.before_handle&&n.before_handle(u,g,b),n.emulator?.platform&&(u.platform=await n.emulator.platform({config:g,prerender:b}))}}_(j),n.prerendering&&!n.prerendering.fallback&&!n.prerendering.inside_reroute&&tt(s);const m=await V(u,()=>t.hooks.handle({event:u,resolve:(g,b)=>V(null,()=>$(g,y,b).then(k=>{for(const S in c){const O=c[S];k.headers.set(S,O)}return Je(k.headers,Object.values(l)),n.prerendering&&g.route.id!==null&&k.headers.set("x-sveltekit-routeid",encodeURI(g.route.id)),k}))}));if(m.status===200&&m.headers.has("etag")){let g=e.headers.get("if-none-match");g?.startsWith('W/"')&&(g=g.substring(2));const b=m.headers.get("etag");if(g===b){const k=new Headers({etag:b});for(const S of["cache-control","content-location","date","expires","vary","set-cookie"]){const O=m.headers.get(S);O&&k.set(S,O)}return new Response(void 0,{status:304,headers:k})}}if(i&&m.status>=300&&m.status<=308){const g=m.headers.get("location");if(g)return ye(new B(m.status,g))}return m}catch(y){if(y instanceof B){const m=i?ye(y):w?.page&&pt(u)?_t(y):ne(y.status,y.location);return Je(m.headers,Object.values(l)),m}return await ze(u,t,y)}async function $(y,m,g){try{if(g&&(x={transformPageChunk:g.transformPageChunk||Ke,filterSerializedResponseHeaders:g.filterSerializedResponseHeaders||Qe,preload:g.preload||Ye}),t.hash_routing||n.prerendering?.fallback)return await Q({event:y,options:t,manifest:r,state:n,page_config:{ssr:!1,csr:!0},status:200,error:null,branch:[],fetched:[],resolve_opts:x});if(w){const b=y.request.method;let k;if(i)k=await qr(y,w,t,r,n,a,j);else if(w.endpoint&&(!w.page||sr(y)))k=await nr(y,await w.endpoint(),n);else if(w.page)if(m)if(Dr.has(b))k=await Hr(y,w.page,t,r,n,m,x);else{const S=new Set(Wr);if((await r._.nodes[w.page.leaf]())?.server?.actions&&S.add("POST"),b==="OPTIONS")k=new Response(null,{status:204,headers:{allow:Array.from(S.values()).join(", ")}});else{const W=[...S].reduce((H,I)=>(H[I]=!0,H),{});k=ct(W,b)}}else throw new Error("page_nodes not found. This should never happen");else throw new Error("Route is neither page nor endpoint. This should never happen");if(e.method==="GET"&&w.page&&w.endpoint){const S=k.headers.get("vary")?.split(",")?.map(O=>O.trim().toLowerCase());S?.includes("accept")||S?.includes("*")||(k=new Response(k.body,{status:k.status,statusText:k.statusText,headers:new Headers(k.headers)}),k.headers.append("Vary","Accept"))}return k}if(n.error&&y.isSubRequest){const b=new Headers(e.headers);return b.set("x-sveltekit-error","true"),await fetch(e,{headers:b})}return n.error?A("Internal Server Error",{status:500}):n.depth===0?(G&&y.url.pathname,await Ot({event:y,options:t,manifest:r,state:n,status:404,error:new J(404,"Not Found",`Not found: ${y.url.pathname}`),resolve_opts:x})):n.prerendering?A("not found",{status:404}):await fetch(e)}catch(b){return await ze(y,t,b)}finally{y.cookies.set=()=>{throw new Error("Cannot use `cookies.set(...)` after the response has been generated")},y.setHeaders=()=>{throw new Error("Cannot use `setHeaders(...)` after the response has been generated")}}}}function Fr(e,t){return Promise.all([...e.layouts.map(r=>r==null?r:t._.nodes[r]()),t._.nodes[e.leaf]()])}function Mr(e,{public_prefix:t,private_prefix:r}){return Object.fromEntries(Object.entries(e).filter(([n])=>n.startsWith(r)&&(t===""||!n.startsWith(t))))}function Gr(e,{public_prefix:t,private_prefix:r}){return Object.fromEntries(Object.entries(e).filter(([n])=>n.startsWith(t)&&(r===""||!n.startsWith(r))))}const Ze={get({type:e},t){throw new Error(`Cannot read values from $env/dynamic/${e} while prerendering (attempted to read env.${t.toString()}). Use $env/static/${e} instead`)}};let Br;class tn{#e;#t;constructor(t){this.#e=Ut,this.#t=t}async init({env:t,read:r}){const n={public_prefix:this.#e.env_public_prefix,private_prefix:this.#e.env_private_prefix},s=Mr(t,n),a=Gr(t,n);Nt(Pe?new Proxy({type:"private"},Ze):s),Lt(Pe?new Proxy({type:"public"},Ze):a),It(a),r&&Dt(r),await(Br??=(async()=>{try{const o=await zt();this.#e.hooks={handle:o.handle||(({event:i,resolve:c})=>c(i)),handleError:o.handleError||(({status:i,error:c})=>console.error(i===404&&c?.message||c)),handleFetch:o.handleFetch||(({request:i,fetch:c})=>c(i)),reroute:o.reroute||(()=>{}),transport:o.transport||{}},o.transport&&Object.fromEntries(Object.entries(o.transport).map(([i,c])=>[i,c.decode])),o.init&&await o.init()}catch(o){throw o}})())}async respond(t,r){return we(t,this.#e,this.#t,{...r,error:!1,depth:0})}}export{tn as Server};
